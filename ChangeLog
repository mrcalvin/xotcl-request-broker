2008-05-12  Stefan Sobernig  <stefan.sobernig@wu-wien.ac.at>

	* www/doc/manual/src: Added new listings package to complete the
	manual build environment. 

	* tcl/20-xorb-procs.tcl: Finally, provide compatibility to naming
	scheme of message types as used by acs-workflow (at least, some
	older versions). Once, you have got acs-workflow installed,
	previous xorb versions might fail or show irritating behaviour as
	they could not handle the four-element scheme to name message
	types. The issue was originally reported by Malte and Emma, thanks
	to you guys for raising hands.

2008-03-26  Stefan Sobernig  <stefan.sobernig@wu-wien.ac.at>

	* Introduced ::xo::library and articulated first file-level
	dependencies.

	* Bumped version number to 0.5d.

	* In XOTcl 1.6+, the semantics of some info subcommands accepting
	string-match kind of patterns has changed (or is more in line with
	Tcl's info) as they return a list of pattern matches rather than
	boolean values. Needed to modify use of some "Class info superclass"
	occurrences.

2008-03-11  Stefan Sobernig  <stefan.sobernig@wu-wien.ac.at>

	* tcl/10-xorb-exceptions-procs.tcl: LoggableException.__classDoc__
	is now defaulted to an empty string, to avoid errors due to
	non-intialisation of this very variable. Thanks to Michael
	Totschnig for reporting.
	Besides, we now report the error stack in both debug and non-debug
	mode. Thanks, again, to Michael Totschnig for the justified
	objection to former default behaviour.

	* tcl/20-xorb-procs.tcl: ::xorb::Abstract->arguments are now
	trimmed for possible dashes before being streamed for storage in
	the back-end. This is promising to increase robustness of the
	::xorb::Abstract interface, allowing for intended or erroneous use
	of dashes when declaring the record parts of the explicit
	interfaces.
	Abstract->stream(): Provide for defaulting of return value
	flags. This was a missing bit, having been intended since the 0.4
	release but forgotten about somehow. Behaviour now corresponds to
	documented one, especially there is no storing error anymore when
	omitting a return value label. 

	* Final maintenance release in 0.4.* genealogy: 0.4.4
	
	* tcl/20-xorb-procs.tcl: Improved robustness of ::xorb::Method
	argument passing behaviour. Formerly, invalid arguments passed
	might have been silently accepted (e.g. missing documentation
	block) causing erroneous behaviour at a later point in time. We,
	now, use internally a parser proc which leverages default XOTcl
	argument parsing behaviour to our method slot implementation.

2008-01-16  Stefan Sobernig  <stefan.sobernig@wu-wien.ac.at>

	* Bumped version number of trunk to 0.4.3

	* tcl/xorb-context-procs.tcl (InvocationInformation): Added
	attribute 'asynchronous' to the top-level class as it is used
	unorthogonally in the request handler (i.e. $context
	asynchronous). This is just a temporary fix and should finally be
	resolved in the upcoming rewrite of the request handler.

2007-12-28  Stefan Sobernig  <stefan.sobernig@wu-wien.ac.at>

	* Manual: Adapting manual to recent 0.4.2 changes, clean-up of demos/
	examples. Thanks to Justis Peters for pointing this out.

2007-12-13  Stefan Sobernig  <stefan.sobernig@wu-wien.ac.at>

	* tcl/xorb-stub-procs.tcl: Moved the history preserving of the
	previous context object into the BlockingRequestor. The feature,
	for now, only makes sense in the blocking context.

	* tcl/xorb-interceptors-procs.tcl: The request handler needs to
	discriminate between blocking/non-blocking mode when proceeding
	from request to the response flow (as there might be a time gap
	and gap of control inbetween). This should be realised in a more
	generic manner in the upcoming state-machine based rewrite, but is
	stable for the time being ... 

2007-12-12  Stefan Sobernig  <stefan.sobernig@wu-wien.ac.at>

	* tcl/20-xorb-procs.tcl: Descriptors of Abstracts are mandatory,
	to easen this requirement, we provided a default (should be
	exchanged by a message key) at some point in time. 

	* www/admin/delete.tcl: Fixed legacy issue with the script still
	calling Broker->stream instead of Broker->get

	* tcl/xorb-broker-procs.tcl: Fixed bug (uninitialised variable
	condition) when deleting orphaned service implementation.

2007-12-05  Stefan Sobernig  <stefan.sobernig@wu-wien.ac.at>

	* www/admin/regression-test.tcl: Fixed the regression test suite,
	i.e. stripped off the interceptor related parts (as they are
	subject of rewrital) and made sure the regression tests run with
	the 0.4.2. It helped to find some minor issues (see policy-related
	changelog comment below).

	* tcl/xorb-deployment-procs.tcl: Recent xotcl-core version,
	i.e. 0.75+, introduce a "policy" privilege called public which
	conflicts the public keyword as used in the invocation access
	policies. While public in ::xo::Policy equals unrestricted access,
	in xorb we refer to the somewhat public access modifier of
	ad_proc/ad_instproc. We renamed the xorb concepts to
	"public_member" and "private_member".

2007-11-14  Stefan Sobernig  <stefan.sobernig@wu-wien.ac.at>

	* tcl/xorb-storm-procs.tcl (TestScenario): Resolved an issue with
	the XML node for streaming the scenario-related report is not
	existing when Guardian operations return (as they are queued
	before the TestScenario ones due to the mixin status). Some fixes
	for the sake of robustness ... 

	* tcl/xorb-datatypes-procs.tcl: Encountered an issue with
	xotcl-core 0.75+ (or even more general). It is common practice in
	xotcl-core to generate object references out of ACS' object_ids,
	e.g. ::xo::Package, ::xo::db::apm_parameter. The same, btw, is
	also valid for ::xowiki::Pages. The issue is not so related to
	this practise, but rather with the scoping of the object
	representations which are created in the global or top-level
	namespace "::". Taking both together, we end up with potential
	conflicts. An example encountered with Anythings in their current
	shape is the following: At some places, we try to discriminate
	objectified or simple string values, to be more precise, whether a
	string is a valid object reference or not, e.g. "::xotcl::Object
	isobject $some_check_string". If $some_check_string stores an
	absolute object reference (with tcl namespace qualifiers) then we
	are fine, however, in case of an potentially unqalified reference,
	e.g. an arbitrary number without any qualifiers, "isobject" will
	fallback to the global namespace. Provided that the global namspace
	is "polluted" by object representations, arbitrary strings
	representing numbers might be resolved to objects and confuscate
	the isobject check. Locally, we solved it by adding another check
	which discriminates the absolutness of the assumed object
	reference: expr {$some_check_string eq [$some_check_string self]}.

	* tcl/xorb-context-procs.tcl: Factored-out the acquisition of a
	type object (information type) and provide for the acquisition
	check at some entry points. Should be more solid now.  

2007-11-07  Stefan Sobernig  <stefan.sobernig@wu-wien.ac.at>

	* tcl/xorb-context-procs.tcl: Major rewrite of the reification
          infrastructure for invocation information and contexts. To
          more neatly support the overlapping concerns of
          "PROVIDER-versus-CONSUMER-side" and
          "PROTOCOL1-versus-PROTOCOL2" and the requirements for a
          uniform interface, we based the re-implementation on the
          TYPE OBJECT pattern. While the first concern
          (broker-related) is modelled as the 'components objects',
          protocol-specific information is contained by 'component
          type objects', associated to the former. Started renaming to
          'invocation information' and 'invocation context'. 

2007-10-25  Stefan Sobernig  <stefan.sobernig@wu-wien.ac.at>

	* Installs smoothly with new environment (xotcl-core etc.)

	* New xotcl-core dependency: 0.75+ (starting with r1.47). The
          xotcl-core db-stub generator for postgresql is now patched
          to provide a "stable" ordering of pg_procs. Background:
          There is a tension between the non-availability of multiple
          dispatch in tcl/xotcl and the variable binding mechanism for
          db procs. Idempotent db procs (having the identical number
          of arguments) haven't been discriminated so far for the
          argument type when selecting a single variant to be turned
          into a xotcl db stub. In certain situations, the interfaces
          casted into stubs might have suggested numeric arguments
          while the variable binding enforced the non-numeric version
          to be called at the db level. This is now solved by ranking
          non-numeric versions of idempotent procs higher than numeric
          ones. this ranking assumes that the oids of non-numeric
          types are higher than those of numeric ones. this seems to
          be valid except from 'char' vs. int*, which might not be an
          issue in OACS as char is not used. 

2007-10-24  Stefan Sobernig  <stefan.sobernig@wu-wien.ac.at>

	* tcl/15-xorb-aux-procs.tcl: Rendered the acs_function_args
          update for acs-kernels pre 5.4.0d1 (due to acs-sc-related
          function_args) conditional upon the xotcl-core version
          installed (<0.74). As 0.4.2 comes with a strict dependency on
          xotcl-core >=0.74, this is mainly measure to allow for backports
          and custom environments.
	  
	  Provided a compat fix for the new db-stub generator: the
	  xorb acs_object infrastructure automatically creates
	  constructors for new types. the parameters need to be
	  streamed into the plpgsql statement in particular manner
	  (eof and tab chars) to be recognised by the new stub generator.

	* tcl/xorb-interceptors-procs.tcl: Again, rewrite (and
          re-conceptualisation) of request handler and interceptor
          logic. Should now have stabilised. There is now a
          consolidated scheme for consumer- and provider-side request
          handlers. The overall flow of action (marshaling,
          interception, invocation data extraction, dispatch,
          delivery) has been generalised and
          "passified". Passification means that interceptors by
          setting properties of the invocation context can easily
          interfere with the flow of requests and responses (to avoid
          unnessary dispatches, etc.). Somewhat, interceptors can
          overrule protocol plug-ins. Also, interceptors and protocol
          plug-ins mixins can now change the type of invocation
          context to realise protocol switches, for instance.

	* tcl/xorb-protocols-procs.tcl: Major clean-up. Removed legacy code.

2007-10-23  Stefan Sobernig  <stefan.sobernig@wu-wien.ac.at>

	* New dependency set: compat to xotcl-core 0.74+: This
          includes some compatibility-related fixes. Adjusted
          xorb::Package to support the improved package support by
          core etc. 

	* Pitched version to 0.4.2 

	* tcl/20-xorb-procs.tcl: Partial rewrite of asynchrony
          support. Support can now be disabled/enabled at wish by
          either mixin-in Requestor::Asynchrony or not. There is now
          to dedicated sub classes, Blocking- and
          NonBlockingRequestor. The latter takes two distinct roles in
          either the scope of the executing connection thread
          (NonBlockingRequestor::ConnectionThread) or the
          serving background thread
          (NonBlockingRequestor::BackgroundThread). 

	* tcl/xorb-broker-procs.tcl: Major bug fix; finally, we
	identified the reason for the mysterious bug  
	"wrong-#-args-should-be-stream" encountered
	occasionally. Background: We use ServiceImplementation and
	ServiceContract as mixins for Broker. These two mixin classes
	come with their own zero-arg stream method. In cases of broker
	failures (look-up) due to a wrong impl name etc., the mixin
	list of broker might not get cleared. This causes follow-up
	stream calls to the Broker to be first handled by the mixin
	classes' methods. This yields the wrong-#-args error as stream
	would not any arguments at this level of the next
	path. Solution: -1- We	change the name of the former
	Broker->stream method to Broker->get -2- We provide for 
	exception catching and explicit cleanup, both at entering the
	Broker and leaving it (also in error conditions).
	In addition, we are now more verbous about contract/
	implementations not found for a given names.

2007-10-22  Stefan Sobernig  <stefan.sobernig@wu-wien.ac.at>

	* tcl/xorb-interceptors-procs.tcl: Fixed sourcing/ precedence
          issue with ClientRequestHandler.

	* tcl/xorb-stub-procs.tcl: Non-blocking consumer support. The
          entire feature set is realised through the mixin class
          Requestor::NonBlocking (connection thread scope),
          AsyncRequestor, and AsyncRequestor::ClientRequestHandler
          (both: background thread scope).

	* tcl/15-xorb-aux-procs.tcl: Added a mixin class Streamable
          that provides for streaming object states into a sourcable
          script. 

	* Introducing basic non-blocking/asynchrony
          support for the consumer side. Non-blockingness is both
          realisied at the level of program flow (delegation to
          background threads) and transport (asynchronous http
          requests etc.). Documentation still missing.

2007-10-08  Stefan Sobernig  <stefan.sobernig@wu-wien.ac.at>

	* Re-organised documentation's tex sources, started
          documentary work on major changes in this revision: extension +
          flow control infrastructure (interceptors), policies, etc. 

	* tcl/xorb-stub-procs.tcl: Code clean-up and aligned context
          object to ::xorb::context::InvocationContext as new base
          class (see below).

	* tcl/xorb-storm-procs.tcl: Fixed an issue with fixtures and
          error aggregation at the parent level.

	* tcl/xorb-context-procs.tcl: Cleaned-up and unified
          context-related infrastructure throughout
          xorb. InvocationContext is now the base class for both
          provider- and consumer-side context types.

	* tcl/xorb-client-procs.tcl: Cleaned-up and introduced new
          consumer-side request handler: ClientRequestHandler.

	* tcl/20-xorb-procs.tcl: Cleaned-up and moved code related to
          request handler + interceptors to xorb-interceptors-procs.tcl.

	* Re-design and re-write of infrastructure for request handlers
          + chain of interceptors and interceptors. Chains and
          interceptors now allow for basic flow control + indirection
          and come with (per-roundtrip) statefulness. Furthermore,
          interceptors can be rendered invokable at a conditional
          basis. We provide some ready-to-use sample interceptors
          (authentication, caching, notification) to
          showcase the new features.

2007-09-21  Stefan Sobernig  <stefan.sobernig@wu-wien.ac.at>

	* tcl/xorb-interceptors-procs.tcl: Provided per-roundtrip
          statefullness to interceptors. Should also support
          invocation schemes with involve exlusively either flow
          direction.

2007-09-20  Stefan Sobernig  <stefan.sobernig@wu-wien.ac.at>

	* tcl/20-xorb-procs.tcl: Allowing the use of ad_doc on
          ::xorb::Abstract (alternatively to "description") in a way
          that the doc string is also used as operation description.

2007-09-18  Stefan Sobernig  <stefan.sobernig@wu-wien.ac.at>

	* tcl/xorb-storm-procs.tcl: Added a first version of the
          scenario-based testing framework as proposed by Mark
          Strembeck. It will be used for future test writing and at
          some point for developer support.

	* tcl/xorb-interceptors-procs.tcl: Added the revised
          interceptor infrastructure, now organised in an own
          *-procs.tcl file. Changed package param "interceptor_config"
          to "chain_of_interceptors".

	* tcl/20-xorb-procs.tcl: Cleaned up, i.e. chunks of commented
          and outdated code.

	* Pitched trunk to 0.4.1

2007-09-14  Stefan Sobernig  <stefan.sobernig@wu-wien.ac.at>

	* tcl/10-xorb-exceptions-procs.tcl: Partial rewrite of
          exception handling, now streaming into versatile xml and
          being more careful to preserve the original error stack
          (errorInfo). 

2007-09-13  Stefan Sobernig  <stefan.sobernig@wu-wien.ac.at>

	* tcl/xorb-context-procs.tcl: Added support for adding/removing
          context data from invocation contexts (setData/getData).

	* tcl/xorb-stub-procs.tcl: Added support for adding/removing
          context data from invocation contexts (setData/getData).

2007-09-12  Stefan Sobernig  <stefan.sobernig@wu-wien.ac.at>

	* tcl/xorb-package-procs.tcl: Fixed a missing exception type
          (PackageException).

2007-09-10  Stefan Sobernig  <stefan.sobernig@wu-wien.ac.at>

	* Updated documentation slightly on new configuration parameters.

2007-09-09  Stefan Sobernig  <stefan.sobernig@wu-wien.ac.at>

	* tcl/20-xorb-procs.tcl: Shifted the package parameter
          interceptor_config to the xorb level (would not make sense
          at the xosoap level).

	* tcl/xorb-package-procs.tcl: Fixed the parameter resolution
          mechanism between protocol packages and the singleton xorb
          package.

2007-09-07  Stefan Sobernig  <stefan.sobernig@wu-wien.ac.at>

	* www/doc/manual/examples/xosoap/example-07-soap-provider-init.tcl
          (echoFloat): Small fix in demo service -> argument in
          contract is meant to be inputFloat, not inputDate! Updated
          documentation. Thanks to Michael Totschnig for the hint.
	  Added missing png to the svn.

2007-09-06  Stefan Sobernig  <stefan.sobernig@wu-wien.ac.at>

	* Tagged 0.4 preview release 

	* tcl/xorb-callback-procs.tcl: Added uninstall logic for 
	anythings of protocol plug-ins! 
	As for upgrades from 0.3 to 0.4, there is currently one
	limitation: contracts and 
	implementations that were defined by non-explicitly named
	::xotcl::Objects (by using new) cannot be identified through
	the allinstances used for upgrades (from within the scope of the
	upgrading connection thread as they were never initiated in
	this very very thread!). This must then be handled manually,
	this won't be a problem in 0.4+ thanks to the object types. 
	Finally, also, cleaned up un-used callbacks.

	* tcl/15-xorb-aux-procs.tcl: Some hacking for a non-errorprone
          installation while using ::xo::db::sql::*

2007-09-05  Stefan Sobernig  <stefan.sobernig@wu-wien.ac.at>

	* tcl/15-xorb-aux-procs.tcl: Added new ::xo::db::require
          function_args call for acs-service-contract packages <
          5.4.0d1

	* Tested for the new ::xo::db::require package
          as introduced by xotcl-core 0.70

2007-09-04  Stefan Sobernig  <stefan.sobernig@wu-wien.ac.at>

	* Pitched requirement to xotcl-core 0.70. The update for
          acs-service-contract < 5.4.0d1 can't be handled by the
          install/ upgrade scripts, therefore it becomes an explicit
          requirement for the current install procedure to execture
          acs-service-contract-function-args.sql on the target db
          before proceeding with the installation.
	
	* tcl/15-xorb-aux-procs.tcl: First adjustment to xotcl-core
          0.70

2007-08-31  Stefan Sobernig  <stefan.sobernig@wu-wien.ac.at>

	* tcl/xorb-callback-procs.tcl: The install routine was missing
          the sourcing of the acs_function_args patches to
          acs-service-contract < 5.4.0d1.  
	  In addition, we need to call ::xo::db::DbPackage again, as
          xorb requires upon first-time sourcing some db stubs in
          place. This should be handled more nicely, by an update call
          to DbPackage in xotcl-core, for instance.

	* Pitched dependencies to xotcl-core 0.57, expecting the
          needed package-require patch being incorporated in the HEAD
          version.

	* tcl/15-xorb-aux-procs.tcl: Adjusted to recent xotcl-core
          versions that shifted DbPackage to the ::xo::db namespace
          instead of ::xo::db::sql; its instances are still placed in
          the old namespace.

2007-08-30  Stefan Sobernig  <stefan.sobernig@wu-wien.ac.at>

	* Added first release version of manual, both in the
          authoritive pdf and xhtml version. A Makefile (and tex4ht
          config) are provided as well to generate either or both
          target formats upon request.

	* tcl/20-xorb-procs.tcl: "Method slot" support is now more
          narrowly scoped: It is limited to slot calls on
          ServiceImplementation objects. This prevents a faulty
          streaming in new thread environments, i.e. object variables
          not being set as "set" calls are not allowed due to the
          revised configure etc.

2007-08-27  Stefan Sobernig  <stefan.sobernig@wu-wien.ac.at>

	* www/admin/regression-test.tcl: The regression test now runs
          smoothly and counts 149 test cases. 

	* tcl/xosc-procs.tcl: We now provide a first (not yet
          complete) proxy implementation for acs service contracts. We
          merged all facilities in this one library file for
          convenience and clarity. It is basically capable of
          declaring static client proxies, a dynamic form (as with
          acs_sc::invoke or acs::sc::call) will follow in a more
          general solution, along with dynamic client proxies in an
          upcoming version.

	* tcl/xorb-stub-procs.tcl: Shifted some attribute slots to
          the base class ContextObject: marshalledRequest,
          marshalledResponse, unmarshalledRequest,
          unmarshalledResponse; assuming that they will be required
          (in one or the other way) by protocol plug-ins. Some fixing
          to exception handling.

	* tcl/xorb-package-procs.tcl: acquireInvocationContext is now
          supported at the base class level (ProtocolPackage).

	* tcl/xorb-datatypes-procs.tcl: Changed remaining entries from
          ::xorb::protocols::Tcl to ::xorb::AcsSc. Extended support
          for ::xorb::datatypes::Object (still tentative and not
          entirely complete, but operative; added unwrap etc.).

	* tcl/xorb-context-procs.tcl: Shifted some attribute slots to
          the base class InvocationContext: marshalledRequest,
          marshalledResponse, unmarshalledRequest,
          unmarshalledResponse; assuming that they will be required
          (in one or the other way) by protocol plug-ins.

	* tcl/xorb-broker-procs.tcl: Implementations are now (more
          accurately) resolvable in dependence of their implementing/
          ruling contract. This required major changes to the overall
          broker implementation, especially Repository->resolve.

	* tcl/20-xorb-procs.tcl: Major changes to the xorb manager
          interface and interaction. Implementations are now treated
          more accurately in terms of their unambiguity as given by
          the implemented contract. Committed a bug fix to the
          recreation logic (Recreate) which resolved multiple
          contracts when re-checking existing bindings. Amended the
          return value checker to support ::xorb::datatypes::Object
          for multi-item return values (and multiples) as required by
          ACS service contracts.

	* tcl/10-xorb-exceptions-procs.tcl: Fixed some typos in
          documentation strings and re-adjusted the way, errorInfo
          information is appended to exception messages in debug
          mode. We are still not completely satisified with the
          latter, but for the time being, it should be fine (and
          verbose enough).

2007-08-26  Stefan Sobernig  <stefan.sobernig@wu-wien.ac.at>

	* tcl/10-xorb-exceptions-procs.tcl: We bound the verbosity
          level of exception messages to the server run level
          (production vs. debug, see aolserver parameter
          "debug"). Whenever we are in run level "debug", we get more
          verbose exception messages. Removed old in-place calls to
          global errorInfo.

	* tcl/00-xoexception/01-throwable-procs.tcl: change parameter
          trace of Throwable to stack, as this would otherwise be
          conflicting to ::xotcl::Object->trace.

2007-08-25  Stefan Sobernig  <stefan.sobernig@wu-wien.ac.at>

	* tcl/xorb-context-procs.tcl: Cleared for legacy code,
          i.e. ContextClass.

	* tcl/xorb-stub-procs.tcl: Disable asynchrony support for the
          release candidate and till the moment, the general
          infrastructure (thread extension) is stabilised.

2007-08-19  Stefan Sobernig  <stefan.sobernig@wu-wien.ac.at>

	* Changed the package parameter "per_instance_policy" to
          "invocation_access_policy". 

	* www/admin/regression-test.tcl: Adjusted test cases related
          to policies etc. 

	* tcl/xorb-package-procs.tcl: Invocation access policies are
          now integrated with protocol packages. Besides, protocol
          packages can initialize a xorb package object at any
          time, in order to use parameters of the request broker in
          their own realm, for instance.

	* tcl/xorb-deployment-procs.tcl: The invocation context is now
          available to the policy subject during evaluation (as object
          variable). It can be used from within conditions, privilege
          etc. definitions.

	* tcl/20-xorb-procs.tcl: The enforcement of invocation access
          policies (check_permissions) moved from the skeleton to the
          invoker, which yields much more flexibility (especially when
          needing the invocation context to be passed further
          down). Conception-wise, this is more straight anyway. 

2007-08-15  Stefan Sobernig  <stefan.sobernig@wu-wien.ac.at>

	* Amended the manual: Added a section on data type
          infrastructure (type codes, anythings, type sponsors), an
          introductory section on the idea of call abstractions, a
          first revision of early sections. 

	* tcl/20-xorb-procs.tcl: Changed a couple of switch-type
          checkoptions to ordinary non-pos args due to a bug in a
          release candidate version of xotcl 1.5.4. It is resolved by
          now, remaining uses of "switch" should be fine.

2007-08-08  Stefan Sobernig  <stefan.sobernig@wu-wien.ac.at>

	* www/doc/manual/src/manual.tex: Added some more infos on
          service implementations (per-object), compiled section on
          data types supported, revised quickstart section and minor
          fixes.  

	* www/admin/index.tcl: State icons now visually identify
          xorb-based implementations.

	* tcl/10-xorb-exceptions-procs.tcl: Fixed a minor issue with
          exceptions in general. some of them contained characters
          such as squared brackets etc. yielding some xml compat
          problems. just removed those in general. when revising the
          logging scheme, we may switch to pcdata or similar for
          marshaling exceptions. Added to new exception types that more
          verbosely catch the very circumstance of not finding a
          contract or an implementation (InterfaceDescriptionNotFound,
          CalleeInterfaceNotFound).

2007-08-07  Stefan Sobernig  <stefan.sobernig@wu-wien.ac.at>

	* www/admin/index.tcl: added some fine features
	to make the admin interface slightly more appealing, 
	completed implementation state display, register/unregister
	of implementations

	* tcl/xorb-broker-procs.tcl: minor change to make
	the (re-)init of binding state more elegant.

2007-08-06  Stefan Sobernig  <stefan.sobernig@wu-wien.ac.at>

	* www/admin/regression-test.tcl: Fixed for new separation
	of connection vs. invocation context. 

	* tcl/xorb-stub-procs.tcl: Added inline documentation for
          ProxyObject, ProxyClass, Object->glue/ad_glue.

	* tcl/xorb-package-procs.tcl: The role of packages has been
          pitched quite strongly, ProtocolPackage hosts some new
          shared functionality for protocol plug-in package types,
	  path resolution, generic dispatcher etc.

	* tcl/xorb-deployment-procs.tcl: Minor bug fix in
          isImplementation condition which was not aware of
	  the internal replacement of :: delimiters by "__".

	* tcl/xorb-context-procs.tcl: The request broker amends
          xotcl-core's connection context by an attribute 'httpMethod'
          (method would be conflicting with
          ::xotcl::Object->method). InvocationContext is now
          independent from ::xo::ConnectionContext

	* tcl/20-xorb-procs.tcl: Re-introduced separation of concern
          between connection contexts (as re-used from xotcl-core) and
          invocation contexts. this required a major rewrite. Added
          inline documentation for ServiceContract, Abstract,
          ServiceImplementation, Delegate, Method.

2007-08-02  Stefan Sobernig  <stefan.sobernig@wu-wien.ac.at>

	* tcl/xorb-deployment-procs.tcl: Fixed another bug introduced
          by the new internal instproc/proc naming scheme in xorb
          (xorb=*) prefixes with the deployment mechanism. Actual, the
          containment check did not work anymore, as the prefixes were
          not taken care of.

	* tcl/20-xorb-procs.tcl: Fixed two nasty bugs. First, the
          current protocol context (needed for sponsorship resolution
          of anythings) was not properly handled for the
          ReturnValueChecker. Second, resolving return value
          declaration (Abstract->returns) was not handled correctly by
          the ReturnValueChecker. Introduced a generic mechanism based
          on a nifty regex. This realises the following syntax for
          return value constraints on Abstracts:
	  1-) "xsString" resolves to "returnValue:xsString"
	  2-) "myLabel:xsString" remains "myLabel:xsString"
	  3-) "" (empty tcl string or returns not set) turns into
          "returnValue:void" 
	  4-) "soapStruct(::xosoap::demo::exampleStruct)" turns into
          "returnValue:soapStruct(::xosoap::demo::exampleStruct)"
	  5-) "myLabel:soapStruct(::xosoap::demo::exampleStruct)"
          remains unchanged
	  6-)
          "myLabel:myLabel:soapStruct(::xosoap::demo::exampleStruct)"
          (faulty!) turns into
          "myLabel:soapStruct(::xosoap::demo::exampleStruct)"
	  

2007-08-01  Stefan Sobernig  <stefan.sobernig@wu-wien.ac.at>
	    
	* Updated manual: Added section on glue objects + graphics 

	* tcl/xorb-stub-procs.tcl: Added inline documentation for
	  ContextObject. Fix regarding indirector generation: Passing
	  an empty/ non-empty body argument to ad_proc/ad_instproc
	  will now decide upon whether both the argument list is
	  filtered (inner/outer record) and a indirector is created.

	* tcl/xorb-datatypes-procs.tcl: Changed the validation
	  semantics of ::xorb::datatypes::String which will now return
	  1/true by default. ::xosoap::xsd::XsString, on the contrary,
	  is now explicitly verified against a range of unicode
	  character codes.

2007-07-30  Stefan Sobernig  <stefan.sobernig@wu-wien.ac.at>

	* www/admin/regression-test.tcl: Added a collection of test
	  cases for the revised method/delegate notations, based upon
	  the method slot idiom.

	* tcl/xorb-datatypes-procs.tcl: Fixed the new sponsorship
	  mechansim across xorb. At some points, it is required to
	  provide the current protocol identifier to the casting
	  mechanism (::xorb::datatypes::Anything->as) or the typecode
	  resolver (::xorb::datatypes::AnyReader). This was now
	  completed and tested (the same goes for the protocol plug-ins).

	* tcl/20-xorb-procs.tcl: Fixed the improved Delegate/Method
	  notation (based upon a basic method slot mechansim) for
	  reflecting ad_(inst)proc and ad_(inst)forward in terms of
	  ad_* specific flags. They now allow for specifying
	  private_p, deprecated_p, warn_p and debug_p. More
	  importantly, Delegate/Method can now be specified on the
	  per-object level, i.e. an instance of ServiceImplementation
	  can now act as valid servant host (formerly, it was always
	  realised on the per-instance, class level). This is more in
	  line with the object-centeredness of XOTcl and realises the
	  per-object attribute as known from XOTcl's attribute
	  slots. It required some changes in the way, the lifecycle
	  manager deals with servant-hosting implementations (at the
	  object level). I added some in-depth test cases to the
	  regression test, according to these, all seems fine.
	  Another major completing step is the introduction of a new
	  xorb-specific type, ::xorb::datatypes::Void. Whenever a
	  contract specification object or rather its abstract slots
	  do not specify an explicit returns type constraint (returns
	  eq {}), we default to void. At the Tcl level, void is
	  semantically equivalent with an empty Tcl string as. At the
	  level of protocol plug-ins, however, expressing the intended
	  voidnesses makes a considerable difference in terms of
	  marshalling of the return value. 

2007-07-27  Stefan Sobernig  <stefan.sobernig@wu-wien.ac.at>

	* tcl/xorb-datatypes-procs.tcl: Introduced a sponsorship
	  infrastructure for Anythings. This is, in particular, useful
	  for specifying placheholderships across protocol
	  domains. The idea is to allow the re-use of contract
	  specifications across these protocol domains, so that a
	  contract once specified for local call abstractions can be
	  re-used as description for a SOAP-based calls. Any object of
	  type MetaPrimitive/MetaComposite can know be assigned as
	  sponsors to another of their kind, but residing in a
	  different protocol scope. Therefore, whenever an Abstract
	  contained arguments of type string
	  (::xorb::datatypes::String), invocations from the SOAP
	  protocol layer will revert to string's sponsor,
	  i.e. ::xosoap::xsd::XsString. Still needs some testing to
	  make sure it fulfills all requirements and I did not miss to
	  align some bits and pieces.

	* tcl/20-xorb-procs.tcl: ::xorb::Object is not featured as acs
	  object type anymore. Contract specifications now allow for
	  specifying a default typecode that is resolvable to a
	  Anything class. This allows to assume defaults (either
	  per-class -- through the attribute slot default -- or
	  per-object) when specifying contracts. This might be used to
	  short-cut the definition of argument lists of
	  ::xorb::Abstracts and it guarantees an overall fallback to
	  ::xorb::datatypes::String if no checkoption was provided at all.

2007-07-26  Stefan Sobernig  <stefan.sobernig@wu-wien.ac.at>

	* www/admin/index.tcl: A rough and crappy admin WUI know comes
	  with the request-broker. I is supposed to ressemble (in the
	  very near future) the functionality by acs-service-contract
	  admin panels. I distinguished between xorb-based and pure
	  acs-based contracts/ implementations, currently in terms of
	  a different set of actions (deletion).

	* tcl/20-xorb-procs.tcl: Finally, proceded and completed the
	  partial rework of the contract/implementation interface. It
	  is a major refinement that aims at realising two types of
	  method slots (in the CLOS sense of the word). They might
	  probably be a feature of XOTcl 1.6 release family, however,
	  in the context of xorb, they allow for declaring (a)
	  delegates (XOTcl: forwards) and (b) methods through object
	  facilities. Initially, we simply allowed for ::xorb::Method
	  in a proc/ instproc style of writing. We extended this to
	  Delegates and, furthermore, streamlined the identity of
	  ServiceContracts and Implementations as (a) ordinary classes
	  and (b) ordinary objects. (a) means that one can know
	  expect a proper instproc when using ::xorb::Method or a
	  forward when using ::xorb::Delegate on
	  Implementations. ServiceImplementations can therefore be
	  instantiated etc. (b) refers to the fact that we now allow
	  the per-object flag on Methods/Delegates,
	  i.e. ServiceImplementations can know provide/contain servant
	  code on the pure object level. This requires to refine the
	  ServantAdapter logic of xorb in the subsequent
	  step. However, this feature refinement reconnects xorb to
	  from where it started: XOTcl. Remains to be tested.
	  Some remarks on the realisation: Slots as such, especially
	  when interfereing or building-upon their basic
	  infrastructure, are tricky to handle in a
	  multi-interpreter/threaded environment with streamed
	  representations. This relates to the fact that they are in
	  fact re-initialised (re-call to the constructor) when
	  turning a stream back into an object. A proper mean to
	  distinguish between declaration + re-init time is the slots
	  method as provided by Class. Streams do not revert to it, so
	  it is convenient to use for the purpose of distinguishing
	  runtime contexts.

	* www/admin/index.tcl: Started realising the admin WUI for the
	  request broker, still heavy work in progress.

	* tcl/xorb-package-procs.tcl: Finally integrated xorb's
	  package facilities with those of xotcl-core. This allows for
	  seamless package initialisation practices in WUI and
	  background setup (filters, ...) as required by
	  xorb. Specialisation is provided for package inits in
	  non-connection contexts.

	* tcl/15-xorb-aux-procs.tcl: Added some query helpers for
	  object types to select subtrees, instances etc.

2007-07-12  Stefan Sobernig  <stefan.sobernig@wu-wien.ac.at>

	* tcl/20-xorb-procs.tcl: While polishing
	  the interface, introduced some namespace import fiddling to
	  allow for pretty-looking contract and implementation
	  declarations: It is know possible to leave out namespace
	  qualifiers when declaring Abstracts, Delegates and Methods.
	  As for Methods, I realised a basic allowance of
	  full-featured, instproc/proc like record declarations
	  (including dashes, checkoptions ...), even in an unescaped
	  manner (without protecting braces). One can now write
	  something like
	  [...]
	  -using {
		 Method myMethod {-arg1:required -arg2} {doc} {;}
	  }
	  [...]
	  There are three major reserved names regarding argument
	  for non-pos arguments: 'mixin', 'set', and 'array' are
	  interpreted by configure and therefore at the object level.
	  As for Delegates, the attribute formerly named 'proxies' is
	  know called 'for', which yields something like
	  [...]
	  -using {
		 Delegate myDelegate -for ::ns::myProc
	  }
	  [...]

2007-07-11  Stefan Sobernig  <stefan.sobernig@wu-wien.ac.at>

	* Initial commit of xorb manual tex source (see www/doc/manual).

	* tcl/xorb-stub-procs.tcl: Removed attribute slot declarations
	  concerning marshalled/ unmarshalled messages
	  from ContextObject and assigned them at the level of
	  xosoap. Revised the resolution order for glue objects by the
	  Requestor: 1- glue objects specified by ad_proc /
	  ad_instproc, 2- proxy object as glue object itself, 3-
	  glueobject instance variable or anything returned by a
	  method glueobject availabe at the level of the proxy object. 
	  Realised "proxy template" feature and distinct handling of
	  outer and inner record in __makeStubBody__. Renamed GObject
	  and GClass to ProxyObject and ProxyClass, respectively.

	* tcl/xorb-datatypes-procs.tcl: Added a new check option to
	  the Checkoption+Uplift mixin that maps 'glue' check options
	  to 'required'. This is used for the 'proxy template' feature
	  as introduced in 0.4.

2007-07-04  Stefan Sobernig  <stefan.sobernig@wu-wien.ac.at>

	* tcl/xorb-deployment-procs.tcl: Added a new aspect to the
	  lazy deployment part of
	  ::xorb::deployment::Checkable::Containment->check to handle
	  situations when an implementation is supposed to be checked
	  against a contract that has just happened to be queued for
	  deployment in the same start-up run!

	* tcl/xorb-datatypes-procs.tcl: Changed ::xorb::MetaAny to
	  ::xorb::MetaPrimitive, added a ::xorb::MetaComposite to
	  identify Typecodes and their anythings that declare
	  themselves to serve as composite structures. The latter is
	  used to remove the last nasty dependency (see
	  CheckOption+Uplift) to the soap protocol plug-in introduced
	  unreflectedly when realising the anything support as such.

	* tcl/xorb-callback-procs.tcl: Added a callback after-install,
	  tested for expected behaviour during
	  installation/de-installation. Fixed typo in boolean expression. 

	* tcl/xorb-adapters-procs.tcl: Fixed typo in if expression.

	* tcl/20-xorb-procs.tcl: Revised the logic for lazy deployment
	  of contracts and implementations. The after-init blocks now
	  take care of processing candidates of all existing
	  subclasses of ServiceContract and ServiceImplementation
	  (Adapters ...). We now store the
	  information of deployment candidates in two separate lists,
	  one containing the suggested names of the specified items,
	  one listing the object references. The former is used in the
	  revised conformance checking scheme of implementations upon
	  server start-up, especially for the case of implementing
	  contracts queued for deployment in the same run!
	  Put the slot-based type validator qname and resolve-to-qname
	  in place on ServiceContract->contract_name,
	  ServiceImplementation->impl_name and
	  ServiceImplementation->impl_contract_name aka implements. 
	  Fixed dropObjectType for contracts: As there is no
	  propagation of contract removals provided either by the ACS
	  SC db scheme, nor the AcsObject* Framework (simply, because
	  Operations and Message Types are not covered by it for now),
	  we need some extra, message type removing logic here. Tested.
	  Added an ::xorb::Invoker->resolve that is simply a hook for
	  protocol plug-ins to provide their own name/object id resolution.

	* tcl/15-xorb-aux-procs.tcl: Fixed
	  ::xorb::aux::AcsObjectType->dropObjectType to handle the
	  deletion of "abstract" object types, those that don't have
	  an attribute table and constructor/destructor.
	  As part of the revised naming/addressing scheme (object ids
	  as used by the protocol plugins and as resolved by the
	  Invoker to internal references), two type validators were
	  added to AcsAttribute: qname and resolve-to-qname. Both
	  verify that names of contracts and implementations do not
	  resolve to protected/ reserved namespaces (xotcl::*,
	  acs::*), the latter being used to provide backward
	  compatibility to legacy contracts and implementations that
	  do not map to tcl namespaces. resolve-to-qname does the some
	  plus resolving values handled by the slot object as
	  namespace which would do relative to the slot object (used
	  for implements of ServiceImplementation).
	  Added a helper method on ::xotcl::Class to expand the
	  subclass tree to a given class (getAllSubClasses).

	* sql/postgresql/...-{create|drop}.sql: Fixed and tested for
	  installation and deinstallation. Major parts are are now
	  handled by the AcsObject* Framework and have been removed
	  from these files. 

2007-07-02  Stefan Sobernig  <stefan.sobernig@wu-wien.ac.at>

	* Re-organised directory structure in www/, added serializer
	  patch for 0.4 which handles the observed issue of
	  re-evaluating variable traces and the streaming ordering
	  applied by the current version of xotcl serializer when
	  streaming slot objects to the blueprint. Note, however, that
	  a more generic solution to this issue is pending, for the
	  moment, the patch allows for running 0.4 and its new features.   

2007-06-28  Stefan Sobernig  <stefan.sobernig@wu-wien.ac.at>

	* tcl/20-xorb-procs.tcl: We introduce the new naming /
	  addressing scheme. Concept-wise, it is the ::xorb::Invoker
	  that acts as main naming/addressing/resolution
	  principal. The invoker is provided with a new method
	  "resolve" that currently implements a single resolution
	  strategy: As we currently only have plug-ins that employ URL
	  based identifiers, we provide for resolving URL components/
	  fragments to 

2007-06-27  Stefan Sobernig  <stefan.sobernig@wu-wien.ac.at>

	* tcl/xorb-deployment-procs.tcl: Revised and simplified the
	  contract retrieval for conformance checking of
	  implementations. Context awareness at this level is now
	  limited to whether the managing thread exists or not. A
	  indirection (for either inside or outside calls to
	  ::xorb::Skeleton->getContract) is now decided within the
	  Skeleton class. Moreover, the non-cached version of Skeleton
	  explicitly removes already initialised skeleton objects
	  residing in its namespace (this was necessary to avoid
	  unwanted recreation). 

	* tcl/20-xorb-procs.tcl: Fixed for the incremental deletion of
	  contracts and implementations. It is not a highly prominent
	  feature but occurred in a test setting. Incremental deletion
	  at the XOTcl layer refers to removing (destroying) a
	  Abstract or Delegate (Method) slot object from a contract or
	  implementation. However, an updating synchronisation in case
	  of contracts requires (for the initial deletion in the
	  update process) all slot objects to be present. By introducing
	  an uniform delete method on Abstracts and Delegates we avoid
	  this issue: In case of contracts, this simply marks slots
	  for destruction for a moment after the deletion of the
	  contract from the db. At the same time they are marked for
	  exclusion from the signature generation in order to set for
	  an update situation. In case of implementations, this work
	  around is not strictly needed as the db schema of
	  acs-service-contract enforces the cascading deletion of
	  Aliases / Delegates. Therefore, a delete simply delegates to
	  destroy.

	* tcl/xorb-datatypes-procs.tcl: Fixed the resolution of
	  Anything subtypes to fully qualified paths to be able to
	  distinguish more accurately between Anything classes based
	  upon the typecode. Started adding a set of xorb native
	  types, i.e. ::xorb::datatypes::String and
	  ::xorb::datatypes::Integer. The list has to be completed 
	  (following the entries in acs_sc_msg_types).

	* tcl/xorb-broker-procs.tcl: Completed another step through a
	  more sound lifecycling of contracts / implementations. on
	  each update on a contract, all previously bound impls are
	  checked for the ex-post conformance and the bindings are
	  reviewed int this respect.

	* tcl/20-xorb-procs.tcl: We introduced, as part of the
	  upcoming revised object reference / addressing scheme some
	  helpers that ascertain canonical reference generations for
	  xorb objects, i.e. service contracts and implementations,
	  for the internal usage (see "canonicalName" as method on
	  ::xorb::Object, ::xorb::ServiceContract,
	  ::xorb::ServiceImplementation). They simply take care of
	  mapping fully qualified tcl references (incl. namespaces)
	  into a underscored notation. 
	  Deletion of service contracts is now fixed for explicitly
	  removing the operations to the contract. 
	  Updated the skeleton generation to behave differently inside
	  or outside the managing thread
	  (::xorb::Skeleton->getContract,
	  ::xorb::Skeleton->getImplementation).
	  Cleaned up the injection of CheckOption+Uplift, i.e. the
	  translation back and forth to Anythings of arguments and
	  return values through the checkoption mechanism: It is now
	  more closely tailored to calling scope of XORB core
	  functions and is cleared when the XORB scope is left
	  (i.e. the actual servant code is called). This avoids to
	  mix-in phantom variables in servant call scopes etc. 
	  The caching of skeletons is now restricted, by default, to
	  generation requests through ::xorb::Invoker, this allows to
	  use the Skeleton generator in cases where caching should be
	  avoided (generating = caching unbound implementations etc.).

	* tcl/15-xorb-aux-procs.tcl: The AcsObject* framework has been
	  partly rewritten. Type constructors are know created for
	  each object type "on foot", e.g. we provide for a stored
	  procedure taking care of populating all supertypes
	  etc. instead of referring to supertype's constructors. 
	  ::xorb::aux::AcsObject now takes care of resolving the closest
	  object type class in reach of a given type instance (see
	  ::xorb::aux::AcsObject->getType). This allows for subtyping class
	  objects of type AcsObjectType without necessarily declaring
	  these subtypes AcsObjectType themselves. 
	  ::xorb::aux::AcsAttribute know allows for value checks on
	  object-scoped variables ('instance variables') through the
	  slot mechanism. This will be part in the revised object id /
	  addressing scheme in 0.4 (see
	  ::xorb::aux::AcsAttribute->xorb=quname). 

	* www/doc/regression-test.tcl: Fixed the request broker FOR
	  most (except for 7) and, most importantly, all critical of
	  the regression tests that come with the request broker. The
	  now reflect the newly introduced features and fixes
	  introduced in version 0.4.

2007-06-20  Stefan Sobernig  <stefan.sobernig@wu-wien.ac.at>

	* tcl/xorb-callback-procs.tcl: Added a before-uninstall
	  callback that unregisters acs_object_types defined for the
	  request broker.

	* tcl/xorb-deployment-procs.tcl: Added a more robust/ generic
	  deployment variant for contracts and implementations. Now,
	  both contracts and implementations have to be explicitly
	  deployed (calling 'deploy' on their specification
	  objects). Behind the scene, it will, depending on the
	  runtime context (intialisation, running instance) either be
	  lazily or instantly synchronised etc. This changes allows to
	  inject contracts and implementations from different
	  contexts, i.e. the developer shell or a web-ui script.

	* tcl/20-xorb-procs.tcl: Started rewriting the the
	  request-broker kernel to make use of the generic OpenACS
	  Object System support that comes with
	  0.4. ::xorb::ServiceContract and
	  ::xorb::ServiceImplementation are partly completed.

	* sql/postgresql/xotcl-request-broker-create.sql: There is a
	  new constructor procedure and extension table for elements
	  to message types in service contracts (constructor:
	  xorb_msg_type_element__new, table:
	  xorb_msg_type_elements_ext). They allow for extending the
	  information model of message type elements independently
	  from the basic message type elements
	  (e.g. element_constraints). As message type elements are not
	  designed as acs_objects, it is somehow hacky. We plan to TIP
	  the amendment of acs-service-contract schema in this manner.

	* sql/postgresql/acs-object-model-function-args.sql: Adding
	  generic upgrade script to register a set of plpgsql stored
	  procedures related to the ACS Object System with with
	  xotcl-core's DB abstraction layer (::xo::db::sql::*). This
	  has, at this point in time, not committed to any version in
	  the OpenACS code base. The upgrade therefore applies to all
	  supported OpenACS versions.

	* sql/postgresql/acs-service-contract-function-args.sql:
	  Adding generic upgrade script to register a set of pgplsql
	  stored procedures with xotcl-core's DB abstraction layer
	  (::xo::db::sql::*). In acs-service-contract => 5.4.0d1, they
	  are integrated with the released package.

	* tcl/xorb-callback-procs.tcl: Added initial callback support
	  for XORB. It will handle upgrade and install refinements
	  starting with release version 0.4.

	* tcl/15-xorb-aux-procs.tcl: Completed the basic set of a XORB
	  framework support for the OpenACS Object System:
	  ::xorb::AcsObjectType and ::xorb::AcsAttribute allows for
	  the management of acs_object_types, ::xorb::AcsObject is the
	  base class for XOTcl representations of acs_objects. The
	  facilities are integrated with the xotcl-core DB abstraction
	  layer (::xo::db::sql::*).

	* ChangeLog: Added this ChangeLog to the repository.
